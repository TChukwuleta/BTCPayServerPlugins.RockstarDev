@using BTCPayServer.Abstractions.Contracts
@using BTCPayServer.Abstractions.Extensions
@using BTCPayServer.Client
@using BTCPayServer.RockstarDev.Plugins.Subscriptions
@using Microsoft.AspNetCore.Mvc.TagHelpers
@inject IScopeProvider ScopeProvider
@{
    var storeId = ScopeProvider.GetCurrentStoreId();
    var activeClass = @ViewData.ActivePageClass(SubscriptionPlugin.SubscriptionPluginNavKey);
    var isActive = !string.IsNullOrWhiteSpace(activeClass);
}
@if (!string.IsNullOrEmpty(storeId))
{
    <li class="nav-item">
        <a permission="@Policies.CanModifyServerSettings"
           asp-controller="Subscription" asp-action="Index" asp-route-storeId="@storeId"
           class="nav-link @ViewData.ActivePageClass(SubscriptionPlugin.SubscriptionPluginNavKey, null, "Subscriptions")">

            <svg class="icon" role="img" viewBox="0 0 24 24">
                <rect x="3" y="5" width="18" height="14" rx="2" ry="2" fill="currentColor"/>
                <path d="M8 3v4M16 3v4M3 10h18" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                <circle cx="12" cy="15" r="2" fill="currentColor"/>
            </svg>

            <span>Subscriptions</span>
        </a>
    </li>

    @if (isActive)
    {
        <li class="nav-item nav-item-sub">
            <a permission="@Policies.CanModifyServerSettings" 
               asp-controller="Product" asp-action="Index" asp-route-storeId="@storeId" 
               class="nav-link @ViewData.ActivePageClass(SubscriptionPlugin.SubscriptionPluginNavKey, null, "Products")">Products</a>
        </li>
        <li class="nav-item nav-item-sub">
            <a permission="@Policies.CanModifyServerSettings" 
               asp-controller="Customer" asp-action="Index" asp-route-storeId="@storeId"
               class="nav-link @ViewData.ActivePageClass(SubscriptionPlugin.SubscriptionPluginNavKey, null, "Customers")">Customers</a>
        </li>
    }
}
